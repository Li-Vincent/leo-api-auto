# LEO API测试平台使用教程

本平台使用的前提是部署成功，请先参照部署教程部署平台。[部署教程](deploy.md)

成功部署项目，并初始化管理员账号后，我们可以使用管理员账号进行登录。登录成功后进入主页。

### 教程菜单
#### [1 用户管理](#1_用户管理)
#### [2 环境配置](#2_环境配置)
#### [3 邮件配置](#3_邮件配置)
#### [4 接口测试](#4_接口测试)

### 1_用户管理
只有超级管理员有 **用户管理** 权限  
管理员账号登录后，点击左侧 Menu **用户管理**

#### 1.1 添加用户
1. 点击 **新增用户** 
2. 输入用户邮箱和密码
3. 选择用户角色
4. 点击 **注册**

#### 1.2 修改权限
1. 点击用户列表右侧的 **编辑**
2. 选择用户角色
3. 点击 **修改权限**

#### 1.3 重置密码
用于用户忘记密码后，请管理员帮忙重置
1. 点击用户列表右侧的 **编辑**
2. 点击 **重置密码**  （重置后 密码为 leo-api-test，需要登录后再修改密码）

#### 1.4 用户权限说明
超级管理员:  
>拥有所有权限，相比项目管理员额外权限为：  
>>用户管理: 添加用户，更改用户角色，初始化用户密码  
>>环境配置: 添加/编辑环境配置，添加/编辑DB连接配置  
>>邮件配置: 发件人配置，添加/编辑收件人分组  

项目管理员:  
>相比普通用户额外权限为:  
>>Project管理: 可以添加/编辑project  
>>配置定时任务  
>>邮件配置: 收件人管理  

普通用户:
>用户: 密码修改  
>用例管理: 用例编辑，调试，全局参数变量添加/编辑，批量导入用例组/导出用例组   
>report查看  

### 2_环境配置
>此平台 **环境配置** 为 *必须配置项*。  
>作用： 配置接口用例执行的环境。

>一般来说，IT项目的环境 分为：开发环境、测试环境、预发布环境、生产环境。  
>既然接口服务部署在多套环境中，那么接口测试自然也要支持多套环境。  
>当服务开发完成后，需要在集成测试环境进行集成测试，上线前需要在预发布环境进行回归测试。  
>只有在此平台上预先配置好测试环境，才能在执行用例时，选择正确的测试环境进行测试。

只有超级管理员有 **环境配置** 权限  
管理员账号登录后，点击左侧 Menu **环境配置** 进入环境配置页面
#### 2.1 测试环境管理
环境信息包含： 环境名称、服务域名、环境描述、环境状态  
关于**服务域名**： 
设置服务域名的目的是 避免在每个接口用例中重复添加域名，只需替换不同的部分即可。
服务域名 不包含 传输协议(http:// or https://)   
由于有些接口服务域名中包含 服务名，所以此平台支持在服务域名中设置一个全局变量${service}，可在执行时进行赋值，value为 接口信息中的 service的值。  
>举例说明：  
>某电商平台 生产环境域名为： buy.com，预发布环境域名为 pre.buy.com, 测试环境 域名为 test.buy.com,  平台存在多个服务，其中两个服务 购物车 和 订单服务 域名为： cart.buy.com 、 order.buy.com  
>对于此种情况 可将预发布环境中的域名设置为 ${service}.pre.buy.com, 在接口信息中设置 service = cart/order，即可在接口用例执行时，替换为相应的值。

**注意：域名中需要区分环境信息**
##### 2.1.1 添加测试环境
1. 进入环境配置页面后，点击 **新增测试环境**
2. 输入 环境名称、域名（域名不包含http:// or https://)、描述 信息
3. 点击 **提交** 保存环境信息
##### 2.1.2 编辑测试环境
1. 进入环境配置页面后，页面会展示 **环境列表**
2. 可以在页面右上角 进行查询，查询条件为 环境名称，支持模糊查询
3. 选择要编辑的 环境信息，点击右侧 **编辑** 按钮
4. 输入 要修改的 名称、域名（域名不包含http:// or https://)、描述 信息
5. 点击 **提交** 保存环境信息
##### 2.1.3 禁用/启用测试环境
1. 进入环境配置页面后，页面会展示 **环境列表**
2. 可以在页面右上角 进行查询，查询条件为 环境名称，支持模糊查询
3. 选择要禁用的 环境信息，点击右侧 **禁用** 按钮（如果环境状态为禁用，则按钮为 **启用**）， 即可禁用/启用 测试环境
4. *如果 测试环境为禁用状态，那么 测试用例执行时，将无法选择到被禁用的测试环境*。

#### 2.2 DB配置管理（数据初始化用）
由于不同接口可能使用不同的DB，所以可能需要多个DB配置
**数据初始化 目前只支持 接口服务数据库为MongoDB， 其他 数据库待实现**  
*进行DB配置前，需先配置好环境信息*  
只有超级管理员有 **DB配置** 权限  
管理员账号登录后，点击左侧 Menu **环境配置** 进入环境配置页面  
点击上方 **DB配置** 进入DB配置页面
##### 2.2.1 添加DB配置
1. 进入DB配置页面后，点击 **新增DB配置**
2. 输入 DB名称、选择DB类型（目前只支持MongoDB)、输入描述 信息
3. 点击 **提交** 保存DB配置
##### 2.2.2 编辑DB配置
1. 进入DB配置页面后，页面会展示 **DB配置列表**
2. 选择要编辑的 DB配置，点击右侧 **编辑** 按钮
2. 输入 DB名称、选择DB类型（目前只支持MongoDB)、输入描述 信息
3. 点击 **提交** 保存DB配置
##### 2.2.3 禁用/启用DB配置
1. 进入DB配置页面后，页面会展示 **DB配置列表**
2. 选择要禁用的 DB配置，点击右侧 **禁用** 按钮（如果DB配置状态为禁用，则按钮为 **启用**）， 即可禁用/启用 DB配置
3. *如果 DB配置为禁用状态，那么 测试用例执行时，将无法选择到被禁用的DB配置*。
##### 2.2.4 DB连接信息管理
由于测试环境有多个，所以DB连接信息需要配置多个环境
1. 进入DB配置页面后，页面会展示 **DB配置列表**
2. 选择要编辑的 DB配置，点击右侧 **连接信息** 按钮， 进入DB环境连接配置页面
3. 页面会根据配置的测试环境展示DB连接信息，点击右侧 **编辑** 按钮
4. 输入DB Host、 Port、 User、 Password、 Name信息
3. 点击 **提交** 保存DB连接配置
6. *需要为每个环境都配置好 DB 连接信息，不然用例执行可能会报错。*


### 3_邮件配置
>此平台 **邮件配置** 的作用为： 定时任务执行完毕后，发送邮件通知。  
>*如不需要发送邮件通知，可不配置*

>平台只能配置一个发件人，*邮件发送使用SMTP服务，所以发件人邮箱需开启SMTP*  
>平台支持收件人分组管理，便于不同的服务，向不同的team人员发送报告

只有超级管理员和项目管理员有 **邮件配置** 权限  
管理员账号登录后，点击左侧 Menu **邮件配置** 进入邮件配置页面
#### 3.1 发件人配置
只有超级管理员有 **发件人配置** 权限  
1. 进入 **邮件配置** 页面后，页面会展示 邮件分组列表
2. 点击 列表上方 **发件人配置** 按钮
3. 输入 邮件标题、发件人邮箱、邮箱授权码、SMTP Server、Port  
[以QQ邮箱为例，获取邮箱授权码的方法](https://jingyan.baidu.com/article/6079ad0eb14aaa28fe86db5a.html)
4. 信息输入完成后，点击 **请先验证** 按钮  
如果配置成功，会收到提示 *验证通过 (\*^▽^\*) 您可以放心「提交」了*  
同时，刚配置的发件人邮箱，会收到自己发送的测试邮件
5. 点击 **提交** 保存发件人配置

#### 3.2 收件人分组管理
只有超级管理员有 **收件人分组管理** 权限  
##### 3.2.1 添加收件人分组
1. 进入 **邮件配置** 页面后，页面会展示 邮件分组列表
2. 点击 列表上方 **新增收件人分组** 按钮
3. 输入 分组 名称、描述 信息
4. 点击 **提交** 保存收件人分组
##### 3.2.2 编辑收件人分组
1. 进入 **邮件配置** 页面后，页面会展示 邮件分组列表
2. 可以在页面右上角 进行查询，查询条件为 分组名称，支持模糊查询
3. 选择要编辑的 收件人分组，点击右侧 **编辑** 按钮
4. 输入 要修改的 名称/描述 信息
5. 点击 **提交** 保存收件人分组
##### 3.2.3 禁用/启用收件人分组
1. 进入 **邮件配置** 页面后，页面会展示 邮件分组列表
2. 可以在页面右上角 进行查询，查询条件为 分组名称，支持模糊查询
3. 选择要禁用的 收件人分组，点击右侧 **禁用** 按钮（如果分组状态为禁用，则按钮为 **启用**）， 即可禁用/启用 收件人分组
4. *如果 收件人分组为禁用状态，那么 定时任务执行后，则不会向此分组的收件人发送通知邮件*。

#### 3.3 收件人邮箱管理
只有超级管理员和项目管理员有 **收件人邮箱管理** 权限  
1. 进入 **邮件配置** 页面后，页面会展示 邮件分组列表
2. 可以在页面右上角 进行查询，查询条件为 分组名称，支持模糊查询  
3. 选择收件人所在的分组，点击 **分组名称** 进入收件人配置页面  
##### 3.3.1 添加收件人  
1. 进入收件人配置页面后，点击 **新增收件人**  
2. 输入 分组 名称、邮箱地址、描述 信息  
3. 点击 **提交** 保存收件人信息  
##### 3.3.2 编辑收件人
1. 进入收件人配置页面后，页面会展示 **收件人列表**
2. 可以在页面右上角 进行查询，查询条件为 邮箱地址，支持模糊查询
3. 选择要编辑的 收件人，点击右侧 **编辑** 按钮
4. 输入 要修改的 名称/邮箱地址/描述 信息
5. 点击 **提交** 保存收件人信息
##### 3.3.3 禁用/启用收件人
1. 进入收件人配置页面后，页面会展示 **收件人列表**
2. 可以在页面右上角 进行查询，查询条件为 邮箱地址，支持模糊查询
3. 选择要禁用的 收件人，点击右侧 **禁用** 按钮（如果状态为禁用，则按钮为 **启用**），即可禁用/启用 收件人
4. *如果 收件人为禁用状态，那么 定时任务执行后，则不会向此收件人发送通知邮件*。


### 4_接口测试
#### 4.1 项目管理
##### 4.1.1 添加项目
##### 4.1.2 编辑项目
##### 4.1.3 删除项目
##### 4.1.4 禁用/启用项目

#### 4.2 用例组管理
##### 4.2.1 添加/编辑用例组
##### 4.2.2 禁用/启用用例组
##### 4.2.3 删除用例组
##### 4.2.4 复制项目
##### 4.2.5 用例组导入/导出

#### 4.3 用例管理
##### 4.3.1 新增接口用例
##### 4.3.2 编辑接口用例
##### 4.3.3 删除接口用例
##### 4.3.4 复制接口用例
##### 4.3.5 禁用/启用用例组

#### 4.4 接口用例详细
##### 4.4.1 基本信息
##### 4.4.2 数据初始化
##### 4.4.3 请求头部
##### 4.4.4 请求参数
##### 4.4.5 返回结果设置全局变量
##### 4.4.6 测试结果校验

#### 4.5 全局参数配置
##### 4.5.1 测试环境查看
##### 4.5.2 新增/编辑参数
##### 4.5.3 删除参数
##### 4.5.4 禁用/启用参数
##### 4.5.5 DB配置查看(数据初始化用)

#### 4.6 接口用例执行
##### 4.6.1 单个接口用例调试
##### 4.6.2 接口用例组执行
##### 4.6.3 定时任务执行
##### 4.6.4 测试报告查看

#### 4.7 定时任务
##### 4.7.1 定时任务新增
##### 4.7.2 定时任务编辑
##### 4.7.3 定时任务启动/停用
##### 4.7.4 邮件通知
##### 4.7.5 测试报告查看

#### 4.8 测试报告
##### 4.8.1 定时任务新增
##### 4.8.2 定时任务编辑
##### 4.8.3 定时任务启动/停用
##### 4.8.4 测试报告查看