webpackJsonp([19],{Jxq8:function(t,e){},wVzg:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("woOf"),s=o.n(r),a=o("H9AI"),n=o("yNht"),i={name:"DBEnvConnect",data:function(){return{dbConfigName:"",listLoading:!1,statusChangeLoading:!1,selects:[],testEnvs:[],dbConfig:{name:"",dbType:""},dbEnvConnects:[{testEnvId:"",testEnvName:"",dbHost:"",dbPort:"",dbUser:"",dbPassword:"",dbName:""}],formVisible:!1,loading:!1,formRules:{dbHost:[{required:!0,message:"请输入Host",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],dbPort:[{required:!0,message:"请输入Port",type:"number",trigger:"blur"}],dbName:[{required:!0,message:"请输入Database Name",trigger:"blur"}]},form:{testEnvId:"",testEnvName:"",dbType:"",dbHost:"",dbPort:"",dbUser:"",dbPassword:"",dbName:""}}},methods:{selectsChange:function(t){this.selects=t},reportRowStyle:function(t){var e=t.row;t.rowIndex;return!0!==e.status?"background-color: #FFF":""},ReportTableRow:function(t){t.row,t.rowIndex;return"reportTableRow"},getTestEnvList:function(){var t=this;Object(a.b)({},{}).then(function(e){var o=e.status,r=e.data;return"ok"===o?t.testEnvs=r.rows:t.$message.error({message:r,center:!0}),r.rows}).catch(function(e){t.$message.error({message:"环境列表获取失败，请稍后刷新重试哦~",center:!0})})},getDBConfigInfo:function(){var t=this;Object(n.b)(this.$route.params.db_config_id).then(function(e){var o=e.status,r=e.data;"ok"===o?t.dbConfig=r:t.$message.error({message:r,center:!0})}).catch(function(e){t.$message.error({message:"DB Config获取失败，请稍后刷新重试哦~",center:!0})})},getDBEnvConnects:function(){var t=this,e=this.testEnvs;this.dbEnvConnects=[];var o=function(o){var r=e[o],s={};s.testEnvId=r._id,s.testEnvName=r.name;var a={testEnvId:r._id,dbConfigId:t.$route.params.db_config_id};Object(n.d)(a,{"Content-Type":"application/json"}).then(function(e){var o=e.status,r=e.data;"ok"===o?r.dbHost&&(s.dbHost=r.dbHost,s.dbPort=r.dbPort,s.dbUser=r.dbUser,s.dbPassword=r.dbPassword,s.dbName=r.dbName):t.$message.error({message:r,center:!0})}).catch(function(e){t.$message.error({message:"DB连接获取失败，请稍后刷新重试哦~",center:!0})}),t.dbEnvConnects.push(s)};for(var r in e)o(r)},handleEdit:function(t,e){this.formVisible=!0,this.form=s()({},this.form,e),this.form.dbType=this.dbConfig.dbType},submit:function(){var t=this,e=this;this.$refs.form.validate(function(o){o&&t.$confirm("确认提交吗？","提示",{}).then(function(){e.loading=!0;var o={dbConfigId:t.$route.params.db_config_id,testEnvId:e.form.testEnvId,dbType:e.form.dbType.trim(),dbHost:e.form.dbHost.trim(),dbPort:e.form.dbPort,dbName:e.form.dbName.trim(),lastUpdateUser:t.$store.getters.email||"anonymous"};e.form.dbUser&&e.form.dbPassword&&(o.dbUser=e.form.dbUser.trim(),o.dbPassword=e.form.dbPassword.trim()),Object(n.f)(o,{"Content-Type":"application/json"}).then(function(t){var o=t.status,r=t.data;e.loading=!1,"ok"===o?(e.$message({message:"修改成功",center:!0,type:"success"}),e.$refs.form.resetFields(),e.formVisible=!1,e.getDBEnvConnects()):(e.$message.error({message:r,center:!0}),e.getDBEnvConnects())})})})}},watch:{testEnvs:{handler:function(t,e){this.getDBEnvConnects()},deep:!0}},created:function(){this.getTestEnvList(),this.getDBConfigInfo()}},l={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",[o("strong",{staticClass:"title"},[t._v(t._s(t.$route.meta.title)+" "),t.dbConfig.name?o("span",[t._v(" - DB: "+t._s(t.dbConfig.name))]):t._e()]),t._v(" "),o("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[o("el-form",{attrs:{inline:!0},nativeOn:{submit:function(t){t.preventDefault()}}},[o("router-link",{staticStyle:{"text-decoration":"none",color:"aliceblue"},attrs:{to:""}},[o("el-button",{staticClass:"return-list",on:{click:function(e){return t.$router.back(-1)}}},[o("i",{staticClass:"el-icon-d-arrow-left",staticStyle:{"margin-right":"5px"}}),t._v("返回\n        ")])],1),t._v(" "),o("el-form-item",{staticStyle:{float:"right","margin-right":"95px"}},[o("el-button",[t._v("*请点击列表中元素的空白处以刷新数据*")])],1)],1)],1),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dbEnvConnects,"row-style":t.reportRowStyle,"row-class-name":t.ReportTableRow,"highlight-current-row":""},on:{"selection-change":t.selectsChange}},[o("el-table-column",{attrs:{type:"selection","min-width":"5%"}}),t._v(" "),o("el-table-column",{attrs:{prop:"testEnvName",label:"环境名称","min-width":"15%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"dbType",label:"DB Type","min-width":"20%","show-overflow-tooltip":""}},[[t.dbConfig.dbType?o("span",[t._v(t._s(t.dbConfig.dbType))]):t._e()]],2),t._v(" "),o("el-table-column",{attrs:{prop:"dbHost",label:"DB Host","min-width":"20%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"dbPort",label:"DB Port","min-width":"20%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"dbUser",label:"DB User","min-width":"20%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"dbPassword",label:"DB Password","min-width":"20%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"dbName",label:"Database Name","min-width":"20%","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作","min-width":"30%"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")])]}}])})],1),t._v(" "),o("el-dialog",{staticStyle:{width:"60%",left:"20%"},attrs:{title:"配置连接信息",visible:t.formVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.formVisible=e}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.formRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"环境名称",prop:"testEnvName"}},[o("el-input",{attrs:{disabled:""},model:{value:t.form.testEnvName,callback:function(e){t.$set(t.form,"testEnvName",e)},expression:"form.testEnvName"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB Type",prop:"dbType"}},[o("el-input",{attrs:{disabled:""},model:{value:t.form.dbType,callback:function(e){t.$set(t.form,"dbType",e)},expression:"form.dbType"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB Host",prop:"dbHost"}},[o("el-input",{attrs:{placeholder:"请输入DB Host","auto-complete":"off"},model:{value:t.form.dbHost,callback:function(e){t.$set(t.form,"dbHost",e)},expression:"form.dbHost"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB Port",prop:"dbPort"}},[o("el-input",{attrs:{placeholder:"请输入DB Port","auto-complete":"off"},model:{value:t.form.dbPort,callback:function(e){t.$set(t.form,"dbPort",t._n(e))},expression:"form.dbPort"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB User",prop:"dbUser"}},[o("el-input",{attrs:{placeholder:"请输入DB Username,可能为空","auto-complete":"off"},model:{value:t.form.dbUser,callback:function(e){t.$set(t.form,"dbUser",e)},expression:"form.dbUser"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB Password",prop:"dbPassword"}},[o("el-input",{attrs:{placeholder:"请输入DB Password,可能为空","auto-complete":"off"},model:{value:t.form.dbPassword,callback:function(e){t.$set(t.form,"dbPassword",e)},expression:"form.dbPassword"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"DB Name",prop:"dbName"}},[o("el-input",{attrs:{placeholder:"请输入DB Name","auto-complete":"off"},model:{value:t.form.dbName,callback:function(e){t.$set(t.form,"dbName",e)},expression:"form.dbName"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{nativeOn:{click:function(e){t.formVisible=!1}}},[t._v("取消")]),t._v(" "),o("el-button",{attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return t.submit(e)}}},[t._v("提交")])],1)],1)],1)},staticRenderFns:[]};var d=o("VU/8")(i,l,!1,function(t){o("Jxq8")},"data-v-6d22cdc7",null);e.default=d.exports}});
//# sourceMappingURL=19.666527075369fc46c467.js.map