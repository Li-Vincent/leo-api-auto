webpackJsonp([27],{"19nU":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterAsyncRoutes=c;var a=n("//Fk"),o=n.n(a),r=n("Dd8w"),i=n.n(r),s=n("YaEn");function c(e,t){var n=[];return e.forEach(function(e){var a=i()({},e);(function(e,t){return!t.meta||!t.meta.roles||e.some(function(e){return t.meta.roles.includes(e)})})(t,a)&&(a.children&&(a.children=c(a.children,t)),n.push(a))}),n}var u={SET_ROUTES:function(e,t){e.dynamicRoutes=t,e.routes=s.b.concat(t)}},l={generateRoutes:function(e,t){var n=e.commit;return new o.a(function(e){var a=void 0;a=t.includes("admin")?s.a||[]:c(s.a,t),n("SET_ROUTES",a),e(a)})}};t.default={namespaced:!0,state:{routes:[],dynamicRoutes:[]},mutations:u,actions:l}},"5W1q":function(e,t){},"7Otq":function(e,t,n){e.exports=n.p+"static/img/logo.cd9f5cb.png"},"7XQ6":function(e,t){},"991W":function(e,t){},GgDs:function(e,t,n){"use strict";n("vMJZ");var a=n("TIfe"),o=n("ytdl"),r=n.n(o),i={name:"Header",props:["projectName"],data:function(){return{sysName:"Leo API AutoTest",collapsed:!1,sysUserName:"",isLogin:!1,logoutLoading:!1}},methods:{login:function(){this.$router.push({name:"login"})},logout:function(){var e=this;this.$confirm("确认退出吗?","提示",{type:"warning"}).then(function(){e.isLogin=!1,e.logoutLoading=!0,e.$store.dispatch("user/logout").then(function(t){e.logoutLoading=!1,e.$message.success({message:t,center:!0}),e.$router.push({name:"login"})}).catch(function(){e.loginLoading=!1})})},collapse:function(){this.collapsed=!this.collapsed,this.$emit("collapse",this.collapsed)}},mounted:function(){try{var e=r()(Object(a.a)()).email;e.trim().length>0&&(this.isLogin=!0),this.sysUserName=e}catch(e){Object(a.b)(),this.$message.error({message:"未获取到用户信息，请重新登录!",center:!0}),this.$router.push({name:"login"})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-col",{staticClass:"header",attrs:{span:24}},[a("el-col",{staticClass:"logo",class:e.collapsed?"logo-collapse-width":"logo-width",attrs:{span:8}},[a("router-link",{staticStyle:{"text-decoration":"none",color:"#FFFFFF"},attrs:{to:"/"}},[a("img",{attrs:{id:"logo",src:n("7Otq")}}),e._v(e._s(e.collapsed?"":e.sysName)+"\n      ")])],1),e._v(" "),a("el-col",{attrs:{span:1}},[a("div",{staticClass:"tools",on:{click:function(t){return t.preventDefault(),e.collapse(t)}}},[a("i",{staticClass:"fa fa-align-justify"})])]),e._v(" "),e.projectName?a("el-col",{staticClass:"project-info",attrs:{span:11}},[a("span",{staticClass:"project-info-inner"},[e._v(e._s(e.projectName))])]):e._e(),e._v(" "),a("el-col",{staticClass:"user-info",attrs:{span:4}},[a("el-dropdown",{attrs:{trigger:"hover"}},[a("span",{staticClass:"el-dropdown-link user-info-inner"},[e._v("\n\t\t\t\t\t\t"+e._s(e.sysUserName)+"\n\t\t\t\t\t\t"),a("img",{attrs:{id:"user-photo",src:n("HNTR")}})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("router-link",{staticStyle:{"text-decoration":"none",color:"#FFFFFF"},attrs:{to:{name:"ChangePassword"}}},[e.isLogin?a("el-dropdown-item",[e._v("修改密码")]):e._e()],1),e._v(" "),e.isLogin?a("el-dropdown-item",{attrs:{loading:e.logoutLoading,divided:""},nativeOn:{click:function(t){return e.logout(t)}}},[e._v("退出登录\n          ")]):e._e(),e._v(" "),e.isLogin?e._e():a("el-dropdown-item",{nativeOn:{click:function(t){return e.login(t)}}},[e._v("登录")])],1)],1)],1)],1)},staticRenderFns:[]};var c=n("VU/8")(i,s,!1,function(e){n("Noja")},"data-v-fc9de4ee",null);t.a=c.exports},HNTR:function(e,t,n){e.exports=n.p+"static/img/user.248b638.gif"},JRgV:function(e,t,n){"use strict";t.b=function(){return Object(a.a)({url:"/api/checkAdminUserExist",method:"POST"})},t.a=function(e){return Object(a.a)({url:"/api/addAdminUser",method:"POST",data:e})};var a=n("cKc3")},LZbd:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("7+uW"),o=n("lbHh"),r=n.n(o),i=(n("7XQ6"),n("zL8q")),s=n.n(i),c=n("wvfG"),u=n.n(c),l=n("nkUn"),d=n.n(l),p=(n("991W"),n("UfKn"),n("LZbd"),n("5W1q"),n("ujtD")),f=n.n(p),m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("router-view")],1)],1)},staticRenderFns:[]};var h=n("VU/8")({name:"App",components:{}},m,!1,function(e){n("UZxG")},null,null).exports,g=n("YaEn"),v=n("NYxO"),b=n("424j"),j={token:function(e){return e.user.token},email:function(e){return e.user.email},roles:function(e){return e.user.roles},routes:function(e){return e.permission.routes},dynamicRoutes:function(e){return e.permission.dynamicRoutes}};a.default.use(v.a);var _=n("w+hY"),T=_.keys().reduce(function(e,t){var n=t.replace(/^\.\/(.*)\.\w+$/,"$1"),a=_(t);return e[n]=a.default,e},{}),O=new v.a.Store({modules:T,getters:j,plugins:[Object(b.a)({storage:window.sessionStorage})]}),E=n("Xxa5"),P=n.n(E),w=n("exGp"),S=n.n(w),k=(n("Dd8w"),n("Y81h")),R=n.n(k),y=(n("UVIz"),n("TIfe")),L=n("JRgV"),C=this;R.a.configure({showSpinner:!1});var x,U=["/login","/404"],M="Leo API Auto Test";g.c.beforeEach((x=S()(P.a.mark(function e(t,n,a){var o,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(R.a.start(),document.title=(n=t.meta.title)?n+" - "+M:""+M,!t.meta.firstAccess){e.next=6;break}Object(L.b)().then(function(e){e.status?(Object(i.Message)({message:"管理员账号已存在："+e.data,center:!0}),a({path:"/login"})):e.data?i.Message.error({message:e.data,center:!0}):a()}),e.next=39;break;case 6:if(!Object(y.a)()){e.next=38;break}if("/login"!==t.path){e.next=13;break}a({path:"/"}),R.a.done(),e.next=36;break;case 13:if(!(O.getters.roles&&O.getters.roles.length>0)){e.next=18;break}a(),e.next=36;break;case 18:return e.prev=18,e.next=21,O.dispatch("user/getUserInfo");case 21:return o=e.sent,r=o.roles,e.next=25,O.dispatch("permission/generateRoutes",r);case 25:e.sent,a(),e.next=36;break;case 29:return e.prev=29,e.t0=e.catch(18),e.next=33,O.dispatch("user/resetToken");case 33:i.Message.error(e.t0||"Has Error"),a("/login?redirect="+t.path),R.a.done();case 36:e.next=39;break;case 38:-1!==U.indexOf(t.path)?a():(a("/login?redirect="+t.path),R.a.done());case 39:case"end":return e.stop()}var n},e,C,[[18,29]])})),function(e,t,n){return x.apply(this,arguments)})),g.c.afterEach(function(){R.a.done()});var A=n("GgDs");a.default.use(f.a),a.default.use(s.a,{size:r.a.get("size")||"medium"}),a.default.use(d.a),a.default.use(u.a),a.default.config.productionTip=!1,a.default.component("header-view",A.a),new a.default({el:"#app",store:O,router:g.c,render:function(e){return e(h)}})},Noja:function(e,t){},TIfe:function(e,t,n){"use strict";t.a=function(){return o.a.get(r)},t.c=function(e){return o.a.set(r,e)},t.b=function(){return o.a.remove(r)};var a=n("lbHh"),o=n.n(a),r="Auth-Token"},UVIz:function(e,t){},UZxG:function(e,t){},UfKn:function(e,t){},YaEn:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s}),t.d=function(){var e=c();u.matcher=e.matcher};var a=n("7+uW"),o=n("/ocq"),r=o.a.prototype.push;o.a.prototype.push=function(e){return r.call(this,e).catch(function(e){return e})},a.default.use(o.a);var i=[{path:"/login",name:"login",component:function(){return n.e(2).then(n.bind(null,"KQvT"))},hidden:!0},{path:"/initAdminUser",name:"InitAdminUser",component:function(){return n.e(13).then(n.bind(null,"cY37"))},hidden:!0,meta:{title:"InitAdminUser",firstAccess:!0}},{path:"/404",name:"notFound",component:function(){return n.e(24).then(n.bind(null,"YcJa"))},hidden:!0},{path:"/project/:project_id",name:"Project",component:function(){return n.e(6).then(n.bind(null,"GYip"))},hidden:!0,projectMenu:!0,children:[{path:"/project/:project_id/autoTest",component:function(){return n.e(14).then(n.bind(null,"DT9f"))},redirect:"/project/:project_id/autoTest/testSuites",name:"AutoTest",nav:"autoTest",meta:{title:"自动化测试"},leaf:!0,child:!0,children:[{path:"/project/:project_id/autoTest/testSuites",component:function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"KrZw"))},name:"TestSuiteList",nav:"autoTest",meta:{title:"用例组列表"}},{path:"/project/:project_id/autoTest/testSuite/:test_suite_id/testCases",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"dHtD"))},name:"TestCaseList",nav:"autoTest",meta:{title:"接口用例列表"}},{path:"/project/:project_id/autoTest/testSuite/:test_suite_id/testCase/:test_case_id/edit",component:function(){return Promise.all([n.e(0),n.e(11)]).then(n.bind(null,"5CZV"))},name:"EditTestCase",nav:"autoTest",meta:{title:"编辑用例"}}]},{path:"/project/:project_id/globalParam",component:function(){return n.e(21).then(n.bind(null,"VviE"))},name:"GlobalParam",leaf:!0,child:!0,nav:"env",meta:{title:"全局参数配置"},children:[{path:"/project/:project_id/globalParam/testEnv/",component:function(){return Promise.all([n.e(0),n.e(15)]).then(n.bind(null,"+FSK"))},name:"TestEnv",nav:"env",meta:{title:"环境配置"}},{path:"/project/:project_id/globalParam/testEnv/:test_env_id/envParams",component:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"xL/h"))},name:"TestEnvParam",nav:"env",meta:{title:"参数配置"}},{path:"/project/:project_id/globalParam/DBConfig/",component:function(){return Promise.all([n.e(0),n.e(17)]).then(n.bind(null,"Ibom"))},name:"DBConfig",nav:"env",meta:{title:"DB配置"}},{path:"/project/:project_id/globalParam/DBConfig/:db_config_id/DBEnvConnect",component:function(){return Promise.all([n.e(0),n.e(18)]).then(n.bind(null,"fJX8"))},name:"DBEnvConnect",nav:"env",meta:{title:"DB环境连接配置"}}]},{path:"/project/:project_id/mailConfig",component:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"4eMQ"))},name:"MailConfig",nav:"mail",meta:{title:"邮件配置"},leaf:!0},{path:"/project/:project_id/cronJob",component:function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"fTqM"))},name:"CronJobList",nav:"cron",meta:{title:"定时任务"},leaf:!0},{path:"/project/:project_id/testReport",component:function(){return n.e(16).then(n.bind(null,"uuuz"))},name:"TestReport",child:!0,nav:"report",meta:{title:"测试报告"},children:[{path:"/project/:project_id/testReports/manual",component:function(){return Promise.all([n.e(0),n.e(20)]).then(n.bind(null,"UXJP"))},name:"TestReportManual",nav:"report",meta:{title:"手动报告"}},{path:"/project/:project_id/testReports/cronJob",component:function(){return Promise.all([n.e(0),n.e(10)]).then(n.bind(null,"ZKLk"))},name:"TestReportCronJob",nav:"report",meta:{title:"任务报告"}},{path:"/project/:project_id/testReport/:report_id",component:function(){return Promise.all([n.e(1),n.e(0)]).then(n.bind(null,"CD3M"))},name:"TestReportDetail",nav:"report",hidden:!0,meta:{title:"报告详情"}}]}]}],s=[{path:"/",name:"Home",component:function(){return n.e(19).then(n.bind(null,"lO7g"))},redirect:"/projects",children:[{path:"/projects",name:"ProjectList",component:function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"Wr8H"))},meta:{title:"接口测试",icon:"fa fa-meetup"}},{path:"/users",component:function(){return Promise.all([n.e(0),n.e(23)]).then(n.bind(null,"H9Oo"))},name:"Users",meta:{title:"用户管理",icon:"fa fa-id-card-o",roles:["admin"]}},{path:"/user/register",component:function(){return n.e(12).then(n.bind(null,"VjfW"))},name:"Register",meta:{title:"用户注册",icon:"fa fa-id-card-o",roles:["admin"]},hidden:!0},{path:"/user/changePassword",component:function(){return n.e(22).then(n.bind(null,"MCyR"))},name:"ChangePassword",meta:{title:"修改密码",icon:"fa fa-id-card-o"},hidden:!0},{path:"/about",name:"About",component:function(){return n.e(25).then(n.bind(null,"c27y"))},meta:{title:"功能介绍",icon:"fa fa-eye"}}]},{path:"*",redirect:"/404",hidden:!0}],c=function(){return new o.a({mode:"history",scrollBehavior:function(){return{y:0}},routes:i.concat(s)})};var u=c();t.c=u},bREw:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("//Fk"),o=n.n(a),r=n("ytdl"),i=(n.n(r),n("TIfe")),s=n("vMJZ"),c=n("YaEn"),u=n("zL8q"),l=(n.n(u),n("Y81h")),d=n.n(l),p=n("UVIz"),f=(n.n(p),{token:Object(i.a)(),email:"",roles:[]}),m={login:function(e,t){var n=e.commit;return new o.a(function(e,a){d.a.start(),Object(s.e)(t).then(function(t){var a=t.status,o=t.data;"ok"===a?(n("SET_TOKEN",o.token),n("SET_EMAIL",o.email),Object(i.c)(o.token),d.a.done(),e()):(u.Message.error({message:o,center:!0}),d.a.done())}).catch(function(e){d.a.done(),a(e)})})},getUserInfo:function(e){var t=e.commit,n=e.state;return new o.a(function(e,a){Object(s.d)(n.email).then(function(n){"ok"!==n.status&&a("Verification failed, please Login again.");var o=n.data.roles;(!o||o.length<=0)&&a("getInfo: roles must be a non-null array!"),t("SET_ROLES",o),e(n.data)}).catch(function(e){a(e)})})},logout:function(e){var t=e.commit;return new o.a(function(e,n){Object(s.f)().then(function(n){var a=n.status,o=n.data;"ok"===a?(console.log("logout successfully"),t("SET_EMAIL",""),t("SET_TOKEN",""),t("SET_ROLES",[]),Object(i.b)(),Object(c.d)(),e(o)):u.Message.error({message:o,center:!0})}).catch(function(e){n(e)})})},resetToken:function(e){var t=e.commit;return new o.a(function(e){t("SET_TOKEN",""),t("SET_ROLES",[]),t("SET_EMAIL",""),Object(i.b)(),e()})}};t.default={namespaced:!0,state:f,mutations:{SET_TOKEN:function(e,t){e.token=t},SET_EMAIL:function(e,t){e.email=t},SET_ROLES:function(e,t){e.roles=t}},actions:m}},cKc3:function(e,t,n){"use strict";var a=n("//Fk"),o=n.n(a),r=n("mtWM"),i=n.n(r),s=n("YaEn"),c=i.a.create({baseURL:Object({NODE_ENV:"production",CASE_IMPORT_URI:"/api/importTestCases"}).BASE_API,withCredentials:!0,timeout:6e4});c.interceptors.response.use(function(e){return e.data},function(e){return e&&e.response?401===e.response.status?(s.c.replace({name:"login"}),{status:"failed",data:"请先登录~"}):302===e.response.status?{status:"failed",data:"当前用户可能被禁用~请联系管理员"}:403===e.response.status?{status:"failed",data:"当前用户没有操作权限哦~请联系管理员"}:500===e.response.status?{status:"failed",data:"服务器内部错误啦~请尝试刷新重试"}:501===e.response.status?{status:"failed",data:"服务器发生神秘事件~请尝试刷新重试"}:502===e.response.status?{status:"failed",data:"服务器网关坏掉啦~请尝试刷新重试"}:503===e.response.status?{status:"failed",data:"服务器不可用啦~请尝试刷新重试"}:504===e.response.status?{status:"failed",data:"服务器响应超时啦~请尝试刷新重试"}:o.a.reject(e.response.data):o.a.reject(e)}),t.a=c},vMJZ:function(e,t,n){"use strict";t.g=function(e,t){return Object(a.a)({url:"/api/register",headers:t,method:"POST",data:e})},t.e=function(e){return Object(a.a)({url:"/api/login",method:"POST",data:e})},t.f=function(){return Object(a.a)({url:"/api/logout",method:"POST"})},t.d=function(e){return Object(a.a)({url:"/api/user/"+e+"/role",method:"GET"})},t.c=function(e){return Object(a.a)({url:"/api/user/users",method:"GET",params:e})},t.i=function(e,t){return Object(a.a)({url:"/api/user/updateStatus",headers:t,method:"POST",data:e})},t.a=function(e,t){return Object(a.a)({url:"/api/user/changePassword",headers:t,method:"POST",data:e})},t.b=function(e,t,n){return Object(a.a)({url:"/api/user/"+e+"/changeRoles",headers:n,method:"POST",data:t})},t.h=function(e,t,n){return Object(a.a)({url:"/api/user/"+e+"/resetPassword",headers:n,method:"POST",data:t})};var a=n("cKc3")},"w+hY":function(e,t,n){var a={"./permission.js":"19nU","./user.js":"bREw"};function o(e){return n(r(e))}function r(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id="w+hY"}},["NHnr"]);
//# sourceMappingURL=app.7942224989c2b5322a2f.js.map